<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Autoxls by pmoracho</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Autoxls</h1>
      <h2 class="project-tagline">An automatic Excel file generator (From SQL data)</h2>
      <a href="https://github.com/pmoracho/autoxls" class="btn">View on GitHub</a>
      <a href="https://github.com/pmoracho/autoxls/raw/master/dist/autoxls-20161027.zip" class="btn">Descarga de ejecutable para windows</a>
    </section>

    <section class="main-content">
      <h1>
<a id="autoxls" class="anchor" href="#autoxls" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Autoxls</h1>

<ul>
<li><a href="https://pmoracho.github.io/autoxls">Página del proyecto</a></li>
<li><a href="https://github.com/pmoracho/autoxls">Proyecto en github</a></li>
<li><a href="https://github.com/pmoracho/autoxls/raw/master/dist/autoxls-20161027.zip">Descarga de ejecutable para windows</a></li>
</ul>

<p><code>autoxls</code> es una herramienta de linea de comandos para automatizar las
generación de archivos Excel 2003 a partir de resultados obtenidos de consultas
a bases de datos.</p>

<h1>
<a id="características-principales" class="anchor" href="#caracter%C3%ADsticas-principales" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Características principales</h1>

<ul>
<li>Múltiples conexiones a bases de datos</li>
<li>Mútiples fuentes de datos</li>
<li>Múltiples consultas/querys/Stored procedures</li>
<li>Capacidad de procesar múltiples recordsets a partir de una única consulta</li>
<li>Generáción automatizada de uno o más archivos Excel por ejecución</li>
<li>Definición dinámica de nombres y textos a partir de "keywords" definidas en
la invocación o por un archivo externo de keywords, puede aplicar:

<ul>
<li>Nombre del archivo</li>
<li>Nombres de las solapas</li>
<li>Textos en la planilla</li>
<li>Parámetros de invocación de la consulta</li>
<li>Datos de la conexión: servidor, usuario, contraseña</li>
</ul>
</li>
<li>Definir multiples solapas por archivo</li>
<li>Automatizar la generación de múltiples objetos

<ul>
<li>textos y filas completas</li>
<li>formulas</li>
<li>grillas de datos o tablas</li>
</ul>
</li>
<li>Definir formatos de los objetos

<ul>
<li>anchos de columnas</li>
<li>colores</li>
<li>tipos de letra</li>
<li>Alineaciones</li>
<li>formatos númericos</li>
</ul>
</li>
</ul>

<h1>
<a id="antes-de-empezar" class="anchor" href="#antes-de-empezar" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Antes de empezar</h1>

<p>Para comenzar, antes de probar la ejecución de esta herramienta, es necesario
escribir un archivo de definición de la exportación a realizar. Este no es más
que un archivo en formato JSON, que describe datos, archivos, planillas y
formatos de la exportación. Nota: para validar el formato del mismo: <a href="http://www.jsoneditoronline.org/">JSON
Editor Online</a>. </p>

<p>Este archivo definirá los siguientes elementos:</p>

<ul>
<li>
<p><strong>datasources</strong>: uno o más conexiones a bases de datos, con las siguientes propiedades:</p>

<ul>
<li>
<strong>data_connect_str</strong>: que establece una conexión a un servidor de
datos.</li>
<li>
<strong>data_query</strong>: que define la correspondiente consulta. Podrá ser una
"query" común o directamente la ejecución de un stored procedure.</li>
<li>
<strong>data_query_file</strong>: Archivo dónde encontramos la consulta SQL.</li>
</ul>
</li>
<li>
<p><strong>files</strong>:  Que define la generación de uno o más archivos Excel. Por cada archivo se podrá definir una o más:</p>

<ul>
<li>
<p><strong>sheets</strong>: Es decir, solapas de la planilla, por cada una de estas se pueden definir varios objetos Excel:</p>

<ul>
<li>
<strong>text</strong>: Texto estático, normalmente titulos, se define la celda, el
texto y el formato.</li>
<li>
<strong>text_rows</strong>: Define una lista de textos estáticos, que se escriben
a partir de una posición en la fila, una celda a continuación de la
otra con un determinado formato</li>
<li>
<strong>text_formated</strong>: Una especialización de los objetos de texto, que
permite aplicar formatos sobre datos recibidos en las <strong>keywords</strong>.</li>
<li>
<strong>datagrid</strong>: Una grilla de datos, la salida final de los datos
recuperados.</li>
<li>
<strong>formulas</strong>: Formulas de escel</li>
<li>
<strong>table</strong>: Una tabla Excel. </li>
</ul>
</li>
</ul>
</li>
<li><p><strong>formats</strong>: Cada objetos se "dibuja" con distintos formatos, estos se
definene a nivel general. Hay dos tipos, los básicos o "primitivos", por
ejemplo: <code>"right": { "align" : "right" }</code> y los compuestos que se definen
como la suma de atributos primitivos, por ejemplo: <code>"encabezado": [
"default_font", "bold", "color", { "bottom" : 1, "bottom_color" : "#0000FF",
"text_wrap": "True", "valign": "top" }]</code>, en este ejemplo "default_font",
"bold", "color" son formatos definidos previamente y  { "bottom" : 1,
"bottom_color" : "#0000FF", "text_wrap": "True", "valign": "top" } es un
primitivo definido en el momento.</p></li>
<li><p><strong>conditional</strong>: Formatos condicionales</p></li>
</ul>

<p>Nota: Para referencia de las definiciones, ver la documentación del módulo <a href="http://xlsxwriter.readthedocs.io/">XlsxWriter</a></p>

<h1>
<a id="construcción-de-la-cadena-dsn-según-datasource" class="anchor" href="#construcci%C3%B3n-de-la-cadena-dsn-seg%C3%BAn-datasource" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Construcción de la cadena Dsn según datasource</h1>

<pre><code>* SQL Server: "DRIVER={SQL Server};SERVER=&lt;&lt;server&gt;&gt;;DATABASE=&lt;&lt;database&gt;&gt;;UID=&lt;&lt;usuario&gt;&gt;;PWD=&lt;&lt;password&gt;&gt;" 
</code></pre>

<h1>
<a id="primeros-pasos" class="anchor" href="#primeros-pasos" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Primeros pasos</h1>

<p>Para entender el funcionamiento de esta herramienta, vamos a imaginar el
siguiente escenario: Tenemos un conjunto de servidores SQL Server y deseamos de
forma automatizada generar un informe a una determinada hora de los procesos
corriendo en los mismos. Para esto contamos con un clásico stored procedure
llamado <code>sp_who2</code>, usando <code>autoxls</code> resulta muy fácil hacer esto. El primer
paso es generar la definición del proceso de exportación de datos, esto lo
haremos escribiendo un archivo JSON similar a este:</p>

<div class="highlight highlight-source-js"><pre>{
    <span class="pl-s"><span class="pl-pds">"</span>datasources<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
        <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span> <span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>data_connect_str<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>DRIVER={SQL Server};SERVER=&lt;&lt;server&gt;&gt;;DATABASE=master;UID=&lt;&lt;user&gt;&gt;;PWD=&lt;&lt;passw&gt;&gt;<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>data_query<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>EXEC sp_who2<span class="pl-pds">"</span></span>
        }
    },
    <span class="pl-s"><span class="pl-pds">"</span>files<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
        {
            <span class="pl-s"><span class="pl-pds">"</span>filename<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>sp_who2 on &lt;&lt;server&gt;&gt;_&lt;&lt;Now&gt;&gt;.xlsx<span class="pl-pds">"</span></span>,
            <span class="pl-s"><span class="pl-pds">"</span>sheets<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                {
                    <span class="pl-s"><span class="pl-pds">"</span>name<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>sp_who2 on &lt;&lt;server&gt;&gt;<span class="pl-pds">"</span></span>,
                    <span class="pl-s"><span class="pl-pds">"</span>default_row_height<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-c1">11.5</span> ,
                    <span class="pl-s"><span class="pl-pds">"</span>objects<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
                        <span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                            { <span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Resultado del sp_who ejecutado el &lt;&lt;Now&gt;&gt; en &lt;&lt;server&gt;&gt;<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>encabezado_titulo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>at<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>B2<span class="pl-pds">"</span></span> }
                        ],
                        <span class="pl-s"><span class="pl-pds">"</span>text_rows<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                            { <span class="pl-s"><span class="pl-pds">"</span>text<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [<span class="pl-c1">null</span>,<span class="pl-c1">null</span>,<span class="pl-c1">null</span>,<span class="pl-c1">null</span>,<span class="pl-c1">null</span>], <span class="pl-s"><span class="pl-pds">"</span>format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>encabezado_titulo<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>at<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>C2<span class="pl-pds">"</span></span> }
                        ],
                        <span class="pl-s"><span class="pl-pds">"</span>datagrid<span class="pl-pds">"</span></span><span class="pl-k">:</span> [
                            {
                                <span class="pl-s"><span class="pl-pds">"</span>source<span class="pl-pds">"</span></span> <span class="pl-k">:</span> {<span class="pl-s"><span class="pl-pds">"</span>datasource<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>data<span class="pl-pds">"</span></span>,<span class="pl-s"><span class="pl-pds">"</span>recordset_index<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-c1">1</span>},
                                <span class="pl-s"><span class="pl-pds">"</span>at<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>B3<span class="pl-pds">"</span></span>,
                                <span class="pl-s"><span class="pl-pds">"</span>header_format<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>encabezado<span class="pl-pds">"</span></span>,
                                <span class="pl-s"><span class="pl-pds">"</span>header_height<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-c1">25</span>,
                                <span class="pl-s"><span class="pl-pds">"</span>freeze_header<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-c1">true</span>,
                                <span class="pl-s"><span class="pl-pds">"</span>datacols<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [
                                                [ <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">"</span>SPID<span class="pl-pds">"</span></span>                     , <span class="pl-c1">8</span>     , <span class="pl-s"><span class="pl-pds">"</span>int<span class="pl-pds">"</span></span>             , <span class="pl-c1">null</span> ],
                                                [ <span class="pl-c1">2</span>, <span class="pl-s"><span class="pl-pds">"</span>Status<span class="pl-pds">"</span></span>                   , <span class="pl-c1">20</span>    , <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>         , <span class="pl-c1">null</span> ],
                                                [ <span class="pl-c1">3</span>, <span class="pl-s"><span class="pl-pds">"</span>Login<span class="pl-pds">"</span></span>                    , <span class="pl-c1">16</span>    , <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>         , <span class="pl-c1">null</span> ],
                                                [ <span class="pl-c1">4</span>, <span class="pl-s"><span class="pl-pds">"</span>HostName<span class="pl-pds">"</span></span>                 , <span class="pl-c1">12</span>    , <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>         , <span class="pl-c1">null</span> ],
                                                [<span class="pl-c1">11</span>, <span class="pl-s"><span class="pl-pds">"</span>ProgramName<span class="pl-pds">"</span></span>              , <span class="pl-c1">60</span>    , <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>         , <span class="pl-c1">null</span> ],
                                                [ <span class="pl-c1">8</span>, <span class="pl-s"><span class="pl-pds">"</span>CpuTime<span class="pl-pds">"</span></span>                  , <span class="pl-c1">12</span>    , <span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>          , <span class="pl-c1">null</span> ]

                                ],
                                <span class="pl-s"><span class="pl-pds">"</span>autofilter_column_range<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [<span class="pl-c1">1</span>,<span class="pl-c1">6</span>],
                                <span class="pl-s"><span class="pl-pds">"</span>subtotals<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [
                                    {<span class="pl-s"><span class="pl-pds">"</span>at<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>END<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>subtotal_int<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>total_function<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>2<span class="pl-pds">"</span></span> , <span class="pl-s"><span class="pl-pds">"</span>cols_num<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [<span class="pl-c1">1</span>] },
                                    {<span class="pl-s"><span class="pl-pds">"</span>at<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>END<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>subtotal<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>total_function<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>9<span class="pl-pds">"</span></span> , <span class="pl-s"><span class="pl-pds">"</span>cols_num<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [<span class="pl-c1">6</span>] }
                                ]
                            }
                        ]
                    }
                }
            ]   
        }
    ],
    <span class="pl-s"><span class="pl-pds">"</span>formats<span class="pl-pds">"</span></span><span class="pl-k">:</span> {
            <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>      <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>font_name<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>Verdana<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>font_size<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-c1">8</span>, <span class="pl-s"><span class="pl-pds">"</span>num_format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>valign<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>top<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span>             <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>align<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>left<span class="pl-pds">"</span></span>              <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>align<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>left<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span>              <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>True<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>color<span class="pl-pds">"</span></span>             <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>bg_color<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>#C6EFCE<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>int_fmt<span class="pl-pds">"</span></span>           <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>num_format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>#,##0<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>number2_fmt<span class="pl-pds">"</span></span>       <span class="pl-k">:</span> { <span class="pl-s"><span class="pl-pds">"</span>num_format<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>#,##0.00<span class="pl-pds">"</span></span> },
            <span class="pl-s"><span class="pl-pds">"</span>default<span class="pl-pds">"</span></span>           <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>left<span class="pl-pds">"</span></span> ] ,
            <span class="pl-s"><span class="pl-pds">"</span>encabezado_titulo<span class="pl-pds">"</span></span> <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>color<span class="pl-pds">"</span></span>],
            <span class="pl-s"><span class="pl-pds">"</span>encabezado<span class="pl-pds">"</span></span>        <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>color<span class="pl-pds">"</span></span>, { <span class="pl-s"><span class="pl-pds">"</span>bottom<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-c1">1</span>, <span class="pl-s"><span class="pl-pds">"</span>bottom_color<span class="pl-pds">"</span></span> <span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>#0000FF<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>text_wrap<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>True<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>valign<span class="pl-pds">"</span></span><span class="pl-k">:</span> <span class="pl-s"><span class="pl-pds">"</span>top<span class="pl-pds">"</span></span> }],
            <span class="pl-s"><span class="pl-pds">"</span>subtotal_int<span class="pl-pds">"</span></span>      <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>int_fmt<span class="pl-pds">"</span></span> ],
            <span class="pl-s"><span class="pl-pds">"</span>subtotal<span class="pl-pds">"</span></span>          <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>bold<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>number2_fmt<span class="pl-pds">"</span></span> ],
            <span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>            <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>number2_fmt<span class="pl-pds">"</span></span> ],
            <span class="pl-s"><span class="pl-pds">"</span>int<span class="pl-pds">"</span></span>               <span class="pl-k">:</span> [ <span class="pl-s"><span class="pl-pds">"</span>default_font<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>right<span class="pl-pds">"</span></span>, <span class="pl-s"><span class="pl-pds">"</span>int_fmt<span class="pl-pds">"</span></span> ]
    }
}</pre></div>

<p>TO DO...</p>

<h1>
<a id="ejecución" class="anchor" href="#ejecuci%C3%B3n" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Ejecución</h1>

<div class="highlight highlight-source-shell"><pre>
uso: autoxls [-h] [-v] [-o <span class="pl-s"><span class="pl-pds">"</span>path<span class="pl-pds">"</span></span>] [-n <span class="pl-k">&lt;</span>level<span class="pl-k">&gt;</span>] [-l file] [-f <span class="pl-s"><span class="pl-pds">"</span>archivo<span class="pl-pds">"</span></span>]
             [-k <span class="pl-s"><span class="pl-pds">'</span>{key:value,key:value}<span class="pl-pds">'</span></span>] [-s]
             [<span class="pl-s"><span class="pl-pds">"</span>archivo<span class="pl-pds">"</span></span>]

Generación automatizada de archivos Excel (v0.9)
2014, 2015, 2016 Patricio Moracho <span class="pl-k">&lt;</span>pmoracho@gmal.com<span class="pl-k">&gt;</span>

argumentos posicionales:
  <span class="pl-s"><span class="pl-pds">"</span>archivo<span class="pl-pds">"</span></span>                               Archivo de entrada (JSON)

argumentos opcionales:
  -h, --help                              mostrar esta ayuda y salir
  -v, --version                           show program<span class="pl-s"><span class="pl-pds">'</span>s version number and exit</span>
<span class="pl-s">  -o "path", --outputpath "path"          Carpeta de salida dónde se almacenaran las planillas</span>
<span class="pl-s">  -n &lt;level&gt;, --loglevel &lt;level&gt;          Nivel de log (default: ninguno)</span>
<span class="pl-s">  -l file, --logfile file                 Archivo de log</span>
<span class="pl-s">  -f "archivo", --keywordfile "archivo"   Archivo de keywords del procesos</span>
<span class="pl-s">  -k <span class="pl-pds">'</span></span>{key:value,key:value}<span class="pl-s"><span class="pl-pds">'</span>, --keywords <span class="pl-pds">'</span></span>{key:value,key:value}<span class="pl-s"><span class="pl-pds">'</span></span>
<span class="pl-s">                                          Keywords del procesos</span>
<span class="pl-s">  -s, --start-excel                       Abrir automáticamente las planillas generadas</span>
<span class="pl-s"></span>
<span class="pl-s"></span></pre></div>

<h1>
<a id="definiciones-de-keywords" class="anchor" href="#definiciones-de-keywords" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Definiciones de keywords</h1>

<p>TO DO..</p>

<h1>
<a id="niveles-de-log" class="anchor" href="#niveles-de-log" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Niveles de log</h1>

<p>Utilizar el parámetro <code>-n</code> o <code>--loglevel</code> para indicar el nivel de información que mostrará la herramienta. Por defecto el nivel es NONE, que no mustra ninguna información.</p>

<table>
<thead>
<tr>
<th>Nível</th>
<th>Detalle</th>
</tr>
</thead>
<tbody>
<tr>
<td>NONE</td>
<td>No motrar ninguna información</td>
</tr>
<tr>
<td>DEBUG</td>
<td>Información detallada, tipicamente análisis y debug</td>
</tr>
<tr>
<td>INFO</td>
<td>Confirmación visual de lo esperado</td>
</tr>
<tr>
<td>WARNING</td>
<td>Información de los eventos no esperados, pero aún la herramienta puede continuar</td>
</tr>
<tr>
<td>ERROR</td>
<td>Errores, alguna funcionalidad no se puede completar</td>
</tr>
<tr>
<td>CRITICAL</td>
<td>Errores serios, el programa no puede continuar</td>
</tr>
</tbody>
</table>

<h1>
<a id="notas-para-el-desarrollador" class="anchor" href="#notas-para-el-desarrollador" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Notas para el desarrollador:</h1>

<h2>
<a id="requisitos-iniciales" class="anchor" href="#requisitos-iniciales" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requisitos iniciales</h2>

<p>El proyecto <strong>autoxls</strong> esta construido usando el lenguaje <strong>python</strong>, a la
fecha no se usan librerías adicionales a las propias de python, pero de todas
formas es recomendable preparar antes que nada, un entorno de desarrollo. A
continuación expondremos en detalle cuales son los pasos para tener preparado
el entorno de desarrollo. Este detalle esta orientado a la implementación sobre
Windows 32 bits, los pasos para versiones de 64 bits son sustancialmente
distintos, en particular por algunos de los "paquetes" que se construyen a
partir de módulos en C o C++, de igual forma la instalación sobre Linux tiene
sus grandes diferencias. Eventualmente profundizaremos sobre estos entornos,
pero en principio volvemos a señalar que el siguiente detalle aplica a los
ambientes Windows de 32 bits:</p>

<ul>
<li><p>Obviamente en primer lugar necesitaremos
<a href="https://www.python.org/ftp/python/3.4.0/python-3.4.0.msi">Python</a>, por ahora
únicamente la versión 3.4. La correcta instalación se debe verificar desde la
línea de comandos: <code>python --version</code>. Si todo se instaló correctamente se
debe ver algo como esto <code>Python 3.4.0</code>, sino verificar que Python.exe se
encuentre correctamente apuntado en el PATH.</p></li>
<li><p>Es conveniente pero no mandatorio hacer upgrade de la herramienta pip:
<code>python -m pip install --upgrade pip</code></p></li>
<li><p><a href="https://virtualenv.pypa.io/en/stable/">Virutalenv</a>. Es la herramienta
estándar para crear entornos "aislados" de python. Para no tener conflictos
de desarrollo lo que haremos mediante esta herramienta es crear un "entorno
virtual" de python en una carpeta del proyecto (venv). Este "entorno virtual"
contendrá una copia completa de Python, al activarlo se modifica el PATH al
python.exe que apuntará ahora a nuestra carpeta del entorno, evitando
cualquier tipo de conflicto con un entorno Python ya existente. La
instalación de virtualenv se hara mediante <code>pip install virtualenv</code></p></li>
<li><p>Descargar el proyecto desde <a href="https://github.com/pmoracho/autoxls">Github</a>, se
puede descargar desde la página el proyecto como un archivo Zip, o si
contamos con <a href="https://git-for-windows.github.io/">Git</a> sencillamente haremos
un <code>git clone https://github.com/pmoracho/parseit</code>.</p></li>
<li><p>El proyecto una vez descomprimido o luego del clonado del repositorio tendrá
una estructura de directorios similar a la siguiente:</p></li>
</ul>

<pre><code>autoxls.git
   |-dist
   |-tests
   |-tools
</code></pre>

<h2>
<a id="requerimientos-adicionales" class="anchor" href="#requerimientos-adicionales" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Requerimientos adicionales</h2>

<p><code>Autoxls</code> requiere las siguientes librerías:</p>

<ul>
<li>
<a href="https://github.com/jmcnamara/XlsxWriter">XlsxWriter</a>: Estupenda libreria
para generar archivos Excel, <code>pip install XlsxWriter</code>. </li>
<li>
<a href="https://github.com/jiangwen365/pypyodbc">pypyodbc</a> para la conectividada
con las bases de datos: <code>pip install pypyodbc</code>
</li>
<li>
<a href="https://github.com/pyinstaller/pyinstaller/">pyinstaller</a> solo si el
objetivo final es construir un ejecutable binario, esta herramienta es
bastante sencilla, para instalar: <code>pip install pyinstaller</code>
</li>
</ul>

<h2>
<a id="preparación-del-entorno-virtual-local" class="anchor" href="#preparaci%C3%B3n-del-entorno-virtual-local" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Preparación del entorno virtual local</h2>

<p>Para poder ejecutar, o crear la distribución de la herramientas, lo primero que
deberemos hacer es armar un entorno python "virtual" que alojaremos en una
subcarpeta del directorio principal que llamaremos "venv". En el proyecto
incorporamos una herramienta de automatización de algunas tareas básicas. Se
trata de <code>make.py</code>, la forma de ejecutarlo es la siguiente: <code>python
tools\make.py &lt;comando&gt;</code> la ejecución si parámetros o mediante el parámetro
<code>--help</code> arrojará una salida como lo que sigue:</p>

<div class="highlight highlight-source-shell"><pre>Automatización de tareas para el proyecto Autoxls
(c) 2016, Patricio Moracho <span class="pl-k">&lt;</span>pmoracho@gmail.com<span class="pl-k">&gt;</span>

Uso: make <span class="pl-k">&lt;</span><span class="pl-c1">command</span><span class="pl-k">&gt;</span> [<span class="pl-k">&lt;</span>args<span class="pl-k">&gt;</span>]

Los comandos más usados:
   devcheck   Hace una verificación del entorno de desarrollo
   devinstall Realiza la instalación del entorno de desarrollo virtual e instala los requerimientos
   docinstall Intalación de Sphinx
   clear      Elimina archivos innecesarios
   <span class="pl-c1">test</span>       Ejecuta todos los tests definidos del proyecto
   build      Construye la distribución binaria de las herramientas del proyecto

argumentos posicionales:
  <span class="pl-c1">command</span>     Comando a ejecutar

argumentos opcionales:
  -h, --help  mostrar esta ayuda y salir</pre></div>

<p>Para preparar el entorno virtual simplemente haremos <code>python tools\make.py
devinstall</code>, este proceso si resulta exitoso deberá haber realizado las
siguientes tareas:</p>

<ul>
<li>Creación de un entorno pyhton virtual en la carpeta "venv", invocable
mediante <code>venv\Scripts\activate.bat</code> en Windows o <code>source
venv/Scripts/activate</code> en entornos Linux o Cygwin/Mingw (en Windows)</li>
<li>Instalado todas las dependencias necesarias</li>
</ul>

<h2>
<a id="notas-adicionales" class="anchor" href="#notas-adicionales" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Notas adicionales:</h2>

<ul>
<li><p>Es recomendable y cómodo, pero entiendo que no es mandatorio, contar con un
entorno estilo "Linux", por ejemplo <a href="http://www.mingw.org/">MinGW</a>, tal como
dice la página del proyecto: "MinGW provides a complete Open Source
programming tool set which is suitable for the development of native
MS-Windows applications, and which do not depend on any 3rd-party C-Runtime
DLLs. (It does depend on a number of DLLs provided by Microsoft themselves,
as components of the operating system; most notable among these is
MSVCRT.DLL, the Microsoft C runtime library. Additionally, threaded
applications must ship with a freely distributable thread support DLL,
provided as part of MinGW itself)." De este entorno requerimos algunas
herramientas de desarrollo: Bash para la línea de comandos y Make para la
automatización de varias tareas del proyecto. </p></li>
<li><p>Usar "soft tabs": Con cualquier editor que usemos configurar el uso del 
en vez de los espacios, yo prefiero el  puro al espacio, entiendo que es
válido el otro criterio pero ya los fuentes están con esta configuración, por
lo que para evitar problemas al compilar los .py recomiendo seguir usando
este criterio. Asimismo configurar en 4 posiciones estos .</p></li>
</ul>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/pmoracho/autoxls">Autoxls</a> is maintained by <a href="https://github.com/pmoracho">pmoracho</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
